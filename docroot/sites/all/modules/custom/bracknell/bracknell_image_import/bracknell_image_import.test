<?php

class BracknellImageImportFilenameTest extends DrupalUnitTestCase {

  private $filename = 'public://foo.jpg';

  /**
   * {@inheritdoc}
   */
  public static function getInfo() {
    return array(
      'name' => 'Bracknell Image Import unit tests',
      'description' => '',
      'group' => 'bracknell',
    );
  }

  /**
   * {@inheritdoc}
   */
  protected function setUp() {
    drupal_load('module', 'bracknell_image_import');

    parent::setUp();
  }

  public function testNoMatches() {
    $uris = array($this->filename);

    $this->assertEqual(
      'public://foo.jpg',
      _bracknell_image_import_get_filename($this->filename, $uris)
    );
  }

  public function testSingleMatch() {
    $uris = array(
      's3://foo.jpg',
      'public://foo.jpg'
    );

    $this->assertEqual(
      'public://foo-0.jpg',
      _bracknell_image_import_get_filename($this->filename, $uris)
    );
  }

  public function testMultipleMatches() {
    $uris = array(
      'public://foo.jpg',
      'public://foo.jpg',
      's3://foo.jpg',
    );

    $this->assertEqual(
      'public://foo-1.jpg',
      _bracknell_image_import_get_filename($this->filename, $uris)
    );

    $uris = array(
      'public://foo.jpg',
      'public://bar.jpg',
      's3://foo.jpg',
      'public://baz.jpg',
      'public://foo.jpg',
      's3://bar.jpg',
      'public://foo.jpg',
    );

    $this->assertEqual(
      'public://foo-2.jpg',
      _bracknell_image_import_get_filename($this->filename, $uris)
    );
  }

}
